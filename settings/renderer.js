import React from 'react';
import { useEffect, useState } from 'react';
import { Button, Label, Tabs, Tab, InputGroup } from '@blueprintjs/core';
import { useIPCValue, useIPCRequest } from '../ipc/renderer';
export function useSetting(name, initialValue) {
    // TODO: Make setting manager send IPC event to renderer when value changed;
    // listen to that event here and relay new value so that widgets are updated.
    // Important if multiple widgets depending on the same setting
    // are shown simultaneously.
    const [localValue, setLocalValue] = useState(initialValue);
    const ipcValue = useIPCValue('settingValue', initialValue, { name });
    useEffect(() => {
        setLocalValue(ipcValue.value);
    }, [ipcValue.value]);
    async function commit() {
        await useIPCRequest('commitSetting', { name, value: localValue });
        ipcValue.refresh();
    }
    return {
        value: localValue,
        // Setting value shown in the widget
        remoteValue: ipcValue.value,
        // Setting value in storage
        changed: () => localValue !== ipcValue.value,
        // True if user manipulated widgetâ€™s local value
        // and the result is different from value in storage
        set: setLocalValue,
        // Updates local value
        commit: commit,
    };
}
const SettingsScreen = function ({ query }) {
    const panes = useIPCValue('settingPaneList', { panes: [] }).
        value.panes;
    const settings = useIPCValue('settingList', { settings: [] }).
        value.settings;
    // Determine whether user was requested to supply specific settings
    let requiredSettingIDs;
    const maybeRequiredSettings = query.get('requiredSettings');
    if (maybeRequiredSettings) {
        requiredSettingIDs = maybeRequiredSettings.split(',');
    }
    else {
        requiredSettingIDs = [];
    }
    let settingWidgetGroup;
    if (requiredSettingIDs.length > 0) {
        settingWidgetGroup = (React.createElement(SettingInputList, { settings: settings.filter(s => requiredSettingIDs.indexOf(s.id) >= 0) }));
    }
    else {
        settingWidgetGroup = (React.createElement(Tabs, null, panes.map(pane => (React.createElement(Tab, { key: pane.id, id: pane.id, title: pane.label, panel: React.createElement(SettingInputList, { settings: settings.filter(s => s.paneID === pane.id) }) })))));
    }
    return React.createElement("div", null, settingWidgetGroup);
};
const SettingInputList = function ({ settings }) {
    const ipcSettings = settings.map((setting) => useSetting(setting.id, ''));
    const hasChangedSettings = ipcSettings.map((setting) => setting.changed()).indexOf(true) >= 0;
    function commitAll() {
        for (const setting of ipcSettings) {
            setting.commit();
        }
    }
    return (React.createElement(React.Fragment, null,
        [...ipcSettings.entries()].map(([idx, s]) => React.createElement(SettingInput, { label: settings[idx].label, ipcSetting: s, key: idx })),
        hasChangedSettings
            ? React.createElement(Button, { onClick: commitAll }, "Save all")
            : null));
};
const SettingInput = function ({ label, ipcSetting }) {
    return (React.createElement(Label, null,
        label,
        React.createElement(InputGroup, { value: ipcSetting.value, type: "text", rightElement: React.createElement(Button, { disabled: !ipcSetting.changed, onClick: ipcSetting.commit, title: "Save setting", icon: "tick" }), onChange: (evt) => {
                ipcSetting.set(evt.target.value);
            } })));
};
export default SettingsScreen;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2V0dGluZ3MvcmVuZGVyZXIudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMxQixPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxNQUFNLE9BQU8sQ0FBQztBQUU1QyxPQUFPLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBSXpFLE9BQU8sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFXN0QsTUFBTSxVQUFVLFVBQVUsQ0FBSSxJQUFZLEVBQUUsWUFBZTtJQUN6RCw0RUFBNEU7SUFDNUUsNkVBQTZFO0lBQzdFLDhEQUE4RDtJQUM5RCw0QkFBNEI7SUFFNUIsTUFBTSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7SUFFM0QsTUFBTSxRQUFRLEdBQUcsV0FBVyxDQUFDLGNBQWMsRUFBRSxZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBRXJFLFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixhQUFhLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBRXJCLEtBQUssVUFBVSxNQUFNO1FBQ25CLE1BQU0sYUFBYSxDQUFDLGVBQWUsRUFBRSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztRQUNsRSxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDckIsQ0FBQztJQUVELE9BQU87UUFDTCxLQUFLLEVBQUUsVUFBVTtRQUNqQixvQ0FBb0M7UUFFcEMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxLQUFL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UUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEdBQUksQ0FBQztRQUN2RSxrQkFBa0I7WUFDakIsQ0FBQyxDQUFDLG9CQUFDLE1BQU0sSUFBQyxPQUFPLEVBQUUsU0FBUyxlQUFtQjtZQUMvQyxDQUFDLENBQUMsSUFBSSxDQUNQLENBQ0osQ0FBQztBQUNKLENBQUMsQ0FBQztBQUdGLE1BQU0sWUFBWSxHQUE4RCxVQUFVLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRTtJQUM3RyxPQUFPLENBQ0wsb0JBQUMsS0FBSztRQUNILEtBQUs7UUFFTixvQkFBQyxVQUFVLElBQ1QsS0FBSyxFQUFFLFVBQVUsQ0FBQyxLQUFLLEVBQ3ZCLElBQUksRUFBQyxNQUFNLEVBQ1gsWUFBWSxFQUNWLG9CQUFDLE1BQU0sSUFDTCxRQUFRLEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxFQUM3QixPQUFPLEVBQUUsVUFBVSxDQUFDLE1BQU0sRUFDMUIsS0FBSyxFQUFDLGNBQWMsRUFDcEIsSUFBSSxFQUFDLE1BQU0sR0FBRyxFQUVsQixRQUFRLEVBQUUsQ0FBQyxHQUFpQyxFQUFFLEVBQUU7Z0JBQzlDLFVBQVUsQ0FBQyxHQUFHLENBQUUsR0FBRyxDQUFDLE1BQTJCLENBQUMsS0FBZSxDQUFDLENBQUM7WUFDbkUsQ0FBQyxHQUFJLENBQ0QsQ0FDVCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBR0YsZUFBZSxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgQnV0dG9uLCBMYWJlbCwgVGFicywgVGFiLCBJbnB1dEdyb3VwIH0gZnJvbSAnQGJsdWVwcmludGpzL2NvcmUnO1xuaW1wb3J0IHsgV2luZG93Q29tcG9uZW50UHJvcHMgfSBmcm9tICcuLi9jb25maWcvcmVuZGVyZXInO1xuXG5pbXBvcnQgeyBQYW5lLCBTZXR0aW5nIH0gZnJvbSAnLi4vc2V0dGluZ3MvbWFpbic7XG5pbXBvcnQgeyB1c2VJUENWYWx1ZSwgdXNlSVBDUmVxdWVzdCB9IGZyb20gJy4uL2lwYy9yZW5kZXJlcic7XG5cblxuaW50ZXJmYWNlIFNldHRpbmdIb29rPFQ+IHtcbiAgdmFsdWU6IFRcbiAgcmVtb3RlVmFsdWU6IFRcbiAgY29tbWl0OiAoKSA9PiBQcm9taXNlPHZvaWQ+XG4gIHNldDogKHZhbHVlOiBUKSA9PiB2b2lkXG4gIGNoYW5nZWQ6ICgpID0+IGJvb2xlYW5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVNldHRpbmc8VD4obmFtZTogc3RyaW5nLCBpbml0aWFsVmFsdWU6IFQpOiBTZXR0aW5nSG9vazxUPiB7XG4gIC8vIFRPRE86IE1ha2Ugc2V0dGluZyBtYW5hZ2VyIHNlbmQgSVBDIGV2ZW50IHRvIHJlbmRlcmVyIHdoZW4gdmFsdWUgY2hhbmdlZDtcbiAgLy8gbGlzdGVuIHRvIHRoYXQgZXZlbnQgaGVyZSBhbmQgcmVsYXkgbmV3IHZhbHVlIHNvIHRoYXQgd2lkZ2V0cyBhcmUgdXBkYXRlZC5cbiAgLy8gSW1wb3J0YW50IGlmIG11bHRpcGxlIHdpZGdldHMgZGVwZW5kaW5nIG9uIHRoZSBzYW1lIHNldHRpbmdcbiAgLy8gYXJlIHNob3duIHNpbXVsdGFuZW91c2x5LlxuXG4gIGNvbnN0IFtsb2NhbFZhbHVlLCBzZXRMb2NhbFZhbHVlXSA9IHVzZVN0YXRlKGluaXRpYWxWYWx1ZSk7XG5cbiAgY29uc3QgaXBjVmFsdWUgPSB1c2VJUENWYWx1ZSgnc2V0dGluZ1ZhbHVlJywgaW5pdGlhbFZhbHVlLCB7IG5hbWUgfSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRMb2NhbFZhbHVlKGlwY1ZhbHVlLnZhbHVlKTtcbiAgfSwgW2lwY1ZhbHVlLnZhbHVlXSk7XG5cbiAgYXN5bmMgZnVuY3Rpb24gY29tbWl0KCkge1xuICAgIGF3YWl0IHVzZUlQQ1JlcXVlc3QoJ2NvbW1pdFNldHRpbmcnLCB7IG5hbWUsIHZhbHVlOiBsb2NhbFZhbHVlIH0pO1xuICAgIGlwY1ZhbHVlLnJlZnJlc2goKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdmFsdWU6IGxvY2FsVmFsdWUsXG4gICAgLy8gU2V0dGluZyB2YWx1ZSBzaG93biBpbiB0aGUgd2lkZ2V0XG5cbiAgICByZW1vdGVWYWx1ZTogaXBjVmFsdWUudmFsdWUsXG4gICAgLy8gU2V0dGluZyB2YWx1ZSBpbiBzdG9yYWdlXG5cbiAgICBjaGFuZ2VkOiAoKSA9PiBsb2NhbFZhbHVlICE9PSBpcGNWYWx1ZS52YWx1ZSxcbiAgICAvLyBUcnVlIGlmIHVzZXIgbWFuaXB1bGF0ZWQgd2lkZ2V04oCZcyBsb2NhbCB2YWx1ZVxuICAgIC8vIGFuZCB0aGUgcmVzdWx0IGlzIGRpZmZlcmVudCBmcm9tIHZhbHVlIGluIHN0b3JhZ2VcblxuICAgIHNldDogc2V0TG9jYWxWYWx1ZSxcbiAgICAvLyBVcGRhdGVzIGxvY2FsIHZhbHVlXG5cbiAgICBjb21taXQ6IGNvbW1pdCxcbiAgICAvLyBTYXZlcyBsb2NhbCB2YWx1ZSBpbiBzdG9yYWdlXG4gIH07XG59XG5cblxuY29uc3QgU2V0dGluZ3NTY3JlZW46IFJlYWN0LkZDPFdpbmRvd0NvbXBvbmVudFByb3BzPiA9IGZ1bmN0aW9uICh7IHF1ZXJ5IH0pIHtcbiAgY29uc3QgcGFuZXMgPSB1c2VJUENWYWx1ZSgnc2V0dGluZ1BhbmVMaXN0JywgeyBwYW5lczogW10gYXMgUGFuZVtdIH0pLlxuICAgIHZhbHVlLnBhbmVzO1xuICBjb25zdCBzZXR0aW5ncyA9IHVzZUlQQ1ZhbHVlKCdzZXR0aW5nTGlzdCcsIHsgc2V0dGluZ3M6IFtdIGFzIFNldHRpbmc8YW55PltdIH0pLlxuICAgIHZhbHVlLnNldHRpbmdzO1xuXG4gIC8vIERldGVybWluZSB3aGV0aGVyIHVzZXIgd2FzIHJlcXVlc3RlZCB0byBzdXBwbHkgc3BlY2lmaWMgc2V0dGluZ3NcbiAgbGV0IHJlcXVpcmVkU2V0dGluZ0lEczogc3RyaW5nW107XG4gIGNvbnN0IG1heWJlUmVxdWlyZWRTZXR0aW5ncyA9IHF1ZXJ5LmdldCgncmVxdWlyZWRTZXR0aW5ncycpXG4gIGlmIChtYXliZVJlcXVpcmVkU2V0dGluZ3MpIHtcbiAgICByZXF1aXJlZFNldHRpbmdJRHMgPSBtYXliZVJlcXVpcmVkU2V0dGluZ3Muc3BsaXQoJywnKTtcbiAgfSBlbHNlIHtcbiAgICByZXF1aXJlZFNldHRpbmdJRHMgPSBbXTtcbiAgfVxuXG4gIGxldCBzZXR0aW5nV2lkZ2V0R3JvdXA6IEpTWC5FbGVtZW50O1xuXG4gIGlmIChyZXF1aXJlZFNldHRpbmdJRHMubGVuZ3RoID4gMCkge1xuICAgIHNldHRpbmdXaWRnZXRHcm91cCA9IChcbiAgICAgIDxTZXR0aW5nSW5wdXRMaXN0XG4gICAgICAgIHNldHRpbmdzPXtzZXR0aW5ncy5maWx0ZXIocyA9PiByZXF1aXJlZFNldHRpbmdJRHMuaW5kZXhPZihzLmlkKSA+PSAwKX1cbiAgICAgIC8+XG4gICAgKTtcblxuICB9IGVsc2Uge1xuICAgIHNldHRpbmdXaWRnZXRHcm91cCA9IChcbiAgICAgIDxUYWJzPlxuICAgICAgICB7cGFuZXMubWFwKHBhbmUgPT4gKFxuICAgICAgICAgIDxUYWJcbiAgICAgICAgICAgIGtleT17cGFuZS5pZH1cbiAgICAgICAgICAgIGlkPXtwYW5lLmlkfVxuICAgICAgICAgICAgdGl0bGU9e3BhbmUubGFiZWx9XG4gICAgICAgICAgICBwYW5lbD17PFNldHRpbmdJbnB1dExpc3Qgc2V0dGluZ3M9e3NldHRpbmdzLmZpbHRlcihzID0+IHMucGFuZUlEID09PSBwYW5lLmlkKX0gLz59XG4gICAgICAgICAgLz5cbiAgICAgICAgKSl9XG4gICAgICA8L1RhYnM+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiA8ZGl2PntzZXR0aW5nV2lkZ2V0R3JvdXB9PC9kaXY+O1xufTtcblxuXG5jb25zdCBTZXR0aW5nSW5wdXRMaXN0OiBSZWFjdC5GQzx7IHNldHRpbmdzOiBTZXR0aW5nPGFueT5bXSB9PiA9IGZ1bmN0aW9uICh7IHNldHRpbmdzIH0pIHtcbiAgY29uc3QgaXBjU2V0dGluZ3MgPSBzZXR0aW5ncy5tYXAoKHNldHRpbmcpID0+IHVzZVNldHRpbmc8c3RyaW5nPihzZXR0aW5nLmlkLCAnJykpO1xuICBjb25zdCBoYXNDaGFuZ2VkU2V0dGluZ3MgPSBpcGNTZXR0aW5ncy5tYXAoKHNldHRpbmcpID0+IHNldHRpbmcuY2hhbmdlZCgpKS5pbmRleE9mKHRydWUpID49IDA7XG4gIGZ1bmN0aW9uIGNvbW1pdEFsbCgpIHtcbiAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgaXBjU2V0dGluZ3MpIHtcbiAgICAgIHNldHRpbmcuY29tbWl0KCk7XG4gICAgfVxuICB9XG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIHtbLi4uaXBjU2V0dGluZ3MuZW50cmllcygpXS5tYXAoKFtpZHgsIHNdOiBbbnVtYmVyLCBTZXR0aW5nSG9vazxhbnk+XSkgPT5cbiAgICAgICAgPFNldHRpbmdJbnB1dCBsYWJlbD17c2V0dGluZ3NbaWR4XS5sYWJlbH0gaXBjU2V0dGluZz17c30ga2V5PXtpZHh9IC8+KX1cbiAgICAgIHtoYXNDaGFuZ2VkU2V0dGluZ3NcbiAgICAgICAgPyA8QnV0dG9uIG9uQ2xpY2s9e2NvbW1pdEFsbH0+U2F2ZSBhbGw8L0J1dHRvbj5cbiAgICAgICAgOiBudWxsfVxuICAgIDwvPlxuICApO1xufTtcblxuXG5jb25zdCBTZXR0aW5nSW5wdXQ6IFJlYWN0LkZDPHsgbGFiZWw6IHN0cmluZywgaXBjU2V0dGluZzogU2V0dGluZ0hvb2s8YW55PiB9PiA9IGZ1bmN0aW9uICh7IGxhYmVsLCBpcGNTZXR0aW5nIH0pIHtcbiAgcmV0dXJuIChcbiAgICA8TGFiZWw+XG4gICAgICB7bGFiZWx9XG5cbiAgICAgIDxJbnB1dEdyb3VwXG4gICAgICAgIHZhbHVlPXtpcGNTZXR0aW5nLnZhbHVlfVxuICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgIHJpZ2h0RWxlbWVudD17XG4gICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgZGlzYWJsZWQ9eyFpcGNTZXR0aW5nLmNoYW5nZWR9XG4gICAgICAgICAgICBvbkNsaWNrPXtpcGNTZXR0aW5nLmNvbW1pdH1cbiAgICAgICAgICAgIHRpdGxlPVwiU2F2ZSBzZXR0aW5nXCJcbiAgICAgICAgICAgIGljb249XCJ0aWNrXCIgLz5cbiAgICAgICAgfVxuICAgICAgICBvbkNoYW5nZT17KGV2dDogUmVhY3QuRm9ybUV2ZW50PEhUTUxFbGVtZW50PikgPT4ge1xuICAgICAgICAgIGlwY1NldHRpbmcuc2V0KChldnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlIGFzIHN0cmluZyk7XG4gICAgICAgIH19IC8+XG4gICAgPC9MYWJlbD5cbiAgKTtcbn07XG5cblxuZXhwb3J0IGRlZmF1bHQgU2V0dGluZ3NTY3JlZW47Il19